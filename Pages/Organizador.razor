@page "/organizador";
@using EjerciciosBlazorServer.Data.Organizador;
@inject Contexto Contexto;

<div class="container-fluid">
    <div class="row">
        <div class="col-xl-4">
            <EditForm Model="@MiLista" OnValidSubmit="GuardarLista">
                <DataAnnotationsValidator />
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <div class="input-group-text">
                            <i class="oi oi-list"></i>
                        </div>
                    </div>
                    <InputText @bind-Value="MiLista.Nombre" class="form-control" placeholder="Nombre de la lista" />
                    <div class="input-group-append">
                        <button class="btn btn-primary" type="submit">Crear</button>
                    </div>
                </div>
            </EditForm>
            <br />
            @foreach (var lista in MisListas)
            {
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <div class="input-group-text">
                            <i class="oi oi-list"></i>
                        </div>
                    </div>
                    @* DEBERÍA VALUE SER BIND-VALUE PARA EDITAR? *@
                    @* TODO: Editar campos *@
                    <input @onclick="(()=>CargarTareas(lista.Id))" value="@lista.Nombre" type="text" class="form-control">
                    <div class="input-group-append">
                        <button class="btn btn-warning" type="button">Editar</button>
                        <button @onclick="(()=>BorrarLista(lista))" class="btn btn-danger" type="button">Borrar</button>
                    </div>
                </div>
            }
        </div>
        <div class="col-xl-4">
            <EditForm Model="@MiTarea" OnValidSubmit="GuardarTarea">
                <DataAnnotationsValidator />
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <div class="input-group-text">
                            <i class="oi oi-circle-check"></i>
                        </div>
                    </div>
                    <InputText @bind-Value="MiTarea.Nombre" class="form-control" placeholder="Nombre de la tarea" />
                    <div class="input-group-append">
                        <button class="btn btn-primary" type="submit">Crear</button>
                    </div>
                </div>
            </EditForm>
            <br />
            @if (MisTareas != null)
            {
                @foreach (var tarea in MisTareas)
                {
                    if (!tarea.Estado)
                    {
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <div class="input-group-text">
                                    <input @bind="@tarea.Estado" @onclick="(()=>CambiarEstadoTarea(tarea.Id))" type="checkbox" />
                                </div>
                            </div>
                            <input @onclick="(()=>CargarPasos(tarea.Id))" value="@tarea.Nombre" type="text" class="form-control">
                            <div class="input-group-append">
                                <button class="btn btn-warning" type="button">Editar</button>
                                <button @onclick="(()=>BorrarTarea(tarea))" class="btn btn-danger" type="button">Borrar</button>
                            </div>
                        </div>
                    }
                }
                <div class="alert alert-success">
                    <b>Completado</b>
                    <span class="oi oi-chevrom-bottom"></span>
                </div>
                @foreach (var tarea in MisTareas)
                {
                    if (tarea.Estado)
                    {
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <div class="input-group-text">
                                    <input @bind="@tarea.Estado" @onclick="(()=>CambiarEstadoTarea(tarea.Id))" type="checkbox" />
                                </div>
                            </div>
                            <input @onclick="(()=>CargarPasos(tarea.Id))" value="@tarea.Nombre" type="text" class="form-control">
                            <div class="input-group-append">
                                <button class="btn btn-warning" type="button">Editar</button>
                                <button @onclick="(()=>BorrarTarea(tarea))" class="btn btn-danger" type="button">Borrar</button>
                            </div>
                        </div>
                    }
                }
            }
        </div>
        <div class="col-xl-4">
            <EditForm Model="@MiPaso" OnValidSubmit="GuardarPaso">
                <DataAnnotationsValidator />
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <div class="input-group-text">
                            <i class="oi oi-check"></i>
                        </div>
                    </div>
                    <InputText @bind-Value="MiPaso.Nombre" class="form-control" placeholder="Nombre del paso" />
                    <div class="input-group-append">
                        <button class="btn btn-primary" type="submit">Crear</button>
                    </div>
                </div>
            </EditForm>
            <br />
            @if (MisPasos != null)
            {
                @foreach (var paso in MisPasos)
                {
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <div class="input-group-text">
                                <input @bind="@paso.Estado" @onclick="(()=>CambiarEstadoPaso(paso.Id))" type="checkbox" />
                            </div>
                        </div>
                        @if (paso.Estado)
                        {
                            <input value="@paso.Nombre" type="text" class="form-control tachado">
                        }
                        else
                        {
                            <input value="@paso.Nombre" type="text" class="form-control">
                        }
                        <div class="input-group-append">
                            <button class="btn btn-warning" type="button">Editar</button>
                            <button @onclick="(()=>BorrarPaso(paso))" class="btn btn-danger" type="button">Borrar</button>
                        </div>
                    </div>
                }
                <textarea></textarea>
            }
        </div>
    </div>
</div>
